本文已参与「新人创作礼」活动，一起开启掘金创作之路

本篇为配置篇的最后一篇（再配人就没了!），这篇的重点是 Vite 配置，以及一些可根据需要添加的配置项。所有的配置文件都建立在项目根目录下。

# Vite

关于 Vite 的配置，官网非常详细，[详情请戳](https://cn.vitejs.dev/)。

## Vite 的包管理工具

在 Vite 源码中，package.json 文件中有这么一串脚本命令：

![image-20220506102804896](https://gitee.com/huohuomua/pictures/raw/master/202205061028944.png)

使用 only-allow 可以强制在项目上使用特定的包管理器，[详细用法](https://github.com/pnpm/only-allow)

所以我们可以了解到，Vite 的源码总强制使用了 pnpm 作为包管理工具。其实在 Vue3 的源码中，我们也可以看到这行命令，实际上也是使用 pnpm 进行包的管理。至于为什么使用 pnpm，而不是 npm 或者 yarn，在系列的第二篇[《（二）Vue3-huohuo-admin 初始化项目篇》](https://juejin.cn/post/7091264650465148964#heading-4)已经做了解释。

这里我们也给项目加上这行命令，来帮助我们统一一下包管理工具的使用。

![image-20220506103709037](https://gitee.com/huohuomua/pictures/raw/master/202205061037080.png)

## Vite dev

首先我们来看一条运行命令

```bash
"dev": "cross-env --max_old_space_size=4096 vite"
```

### 打开内存限制

> --max_old_space_size 是什么，为什么设置 4096？

内存限制参数。当为正在执行的应用程序（你的项目比较大时）分配的内存小于所需内存时，会发生内存不足的错误。因为默认情况下，Node.js 中的内存限制为 512MB，这时候我们就需要处理内存限制问题。一般来说，在前端项目中，我会分配四分之一（4G）的主机内存供项目运行

```bash
node --max-old-space-size=1024 index.js #increase to 1gb
node --max-old-space-size=2048 index.js #increase to 2gb
node --max-old-space-size=3072 index.js #increase to 3gb
node --max-old-space-size=4096 index.js #increase to 4gb
node --max-old-space-size=5120 index.js #increase to 5gb
node --max-old-space-size=6144 index.js #increase to 6gb
node --max-old-space-size=7168 index.js #increase to 7gb
node --max-old-space-size=8192 index.js #increase to 8gb
```

### dev or serve?

有些同学可能会迷糊（比如曾经的我）：如果你是以前习惯了这个命令 pnpm(npm) run serve 来运行项目，然后...

![image-20220506202511224](https://gitee.com/huohuomua/pictures/raw/master/202205062025271.png)

我们 package.json 中 scripts 脚本根本都没有这个命令啊！

我们换成 pnpm run dev（或者懒人写法 pnpm dev）就可以成功运行项目。实际上，pnpm run xxx 就只是运行 package.json 里配置的一个脚本。

如果你实在习惯了 serve，那就改一下...

![image-20220506203153283](https://gitee.com/huohuomua/pictures/raw/master/202205062031318.png)

这个改写还能帮你在使用 npm 命令来运行项目的时候，自动帮你以 pnpm 来运行。我们直接用 pnpm serve 把项目跑起来吧！

![image-20220506203549060](https://gitee.com/huohuomua/pictures/raw/master/202205062035096.png)

## Vite env

### cross-env

在上一小部分，我们看到 dev 命令中有一个配置项叫[cross-env](https://www.npmjs.com/package/cross-env)。

**作用**：当我们使用如 NODE_ENV = production 来设置环境变量的时候，大多数 Windows 命令会提示将会阻塞或者异常。或者 Windows 不支持 NODE_ENV=development 的这样的设置方式时，会报错。而 cross-env 的出现让我们不用再担心平台设置或环境变量的使用。也就是说 cross-env 能够提供一个设置环境变量的 scripts，这样我们就能够以 unix 方式设置环境变量，并且在 windows 上兼容。

安排上

```bash
pnpm install -D cross-env
```

我们可以将这个选项使用在 dev 或者 build 等命令上

![image-20220506210007799](https://gitee.com/huohuomua/pictures/raw/master/202205062100828.png)

### env 环境配置文件

# 其他配置文件

## .editconfig 文件

## .gitpod.yml 文件

## CHANGELOG.md 和 README.md 文件

## deploy.sh 文件

## LICENSE

## README.md
